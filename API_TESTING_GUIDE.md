#!/bin/bash

# ğŸ§ª Supabase Functions Testing Guide
# Complete curl commands for testing all Edge Functions

PROJECT_ID="ngduavjaiqyiqjzelfpl"
PROJECT_URL="https://${PROJECT_ID}.supabase.co"

echo "ğŸ§ª API Testing Guide for Jeenius 1.0"
echo "===================================="
echo ""
echo "Project URL: $PROJECT_URL"
echo ""
echo "Note: For authenticated endpoints, replace BEARER_TOKEN with your JWT token"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "1ï¸âƒ£  JEENIE - AI DOUBT SOLVER"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Description: Ask JEEnie AI any study-related question"
echo "Required: GEMINI_API_KEY"
echo "Auth: No (public)"
echo ""
echo "curl -X POST $PROJECT_URL/functions/v1/jeenie \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -d '{"
echo "    \"contextPrompt\": \"What is Newton'"'"'s first law of motion?\","
echo "    \"conversationHistory\": \"Previous context about motion (optional)\""
echo "  }'"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "2ï¸âƒ£  TEXT-TO-SPEECH"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Description: Convert text to high-quality speech audio"
echo "Required: OPENAI_API_KEY"
echo "Auth: No (public)"
echo "Returns: MP3 audio data"
echo ""
echo "curl -X POST $PROJECT_URL/functions/v1/text-to-speech \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -d '{"
echo "    \"text\": \"Integration by parts is a powerful technique in calculus\","
echo "    \"voice\": \"nova\"  /* Options: nova, alloy, echo, fable, onyx, shimmer */"
echo "  }' > output.mp3"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "3ï¸âƒ£  VOICE-TO-TEXT"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Description: Convert audio file to text (voice notes)"
echo "Required: None (built-in)"
echo "Auth: No (public)"
echo ""
echo "Note: Audio must be base64 encoded"
echo ""
echo "# Encode your audio file first:"
echo "base64 audio_file.wav > audio_base64.txt"
echo ""
echo "# Then send with curl:"
echo "curl -X POST $PROJECT_URL/functions/v1/voice-to-text \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -d '{"
echo "    \"audio\": \"<base64_encoded_audio_data>\""
echo "  }'"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "4ï¸âƒ£  CALCULATE TOPIC MASTERY"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Description: Calculate student'"'"'s proficiency in a topic"
echo "Required: Valid JWT token"
echo "Auth: Yes (Bearer token required)"
echo ""
echo "curl -X POST $PROJECT_URL/functions/v1/calculate-topic-mastery \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -H 'Authorization: Bearer BEARER_TOKEN' \\"
echo "  -d '{"
echo "    \"subject\": \"Physics\","
echo "    \"chapter\": \"Mechanics\","
echo "    \"topic\": \"Newton'"'"'s Laws\""
echo "  }'"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "5ï¸âƒ£  GENERATE STUDY PLAN"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Description: Generate AI-powered personalized study plan"
echo "Required: GEMINI_API_KEY, Valid JWT"
echo "Auth: Yes (Bearer token required)"
echo ""
echo "curl -X POST $PROJECT_URL/functions/v1/generate-study-plan \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -H 'Authorization: Bearer BEARER_TOKEN' \\"
echo "  -d '{"
echo "    \"userId\": \"user-uuid\","
echo "    \"studyHours\": 5,"
echo "    \"targetExam\": \"JEE Main\","
echo "    \"daysRemaining\": 120,"
echo "    \"strengths\": ["
echo "      {\"subject\": \"Physics\", \"topic\": \"Mechanics\", \"accuracy\": 85, \"questions_attempted\": 50}"
echo "    ],"
echo "    \"weaknesses\": ["
echo "      {\"subject\": \"Chemistry\", \"topic\": \"Organic\", \"accuracy\": 45, \"questions_attempted\": 30}"
echo "    ],"
echo "    \"avgAccuracy\": 72"
echo "  }'"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "6ï¸âƒ£  CREATE RAZORPAY ORDER"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Description: Create payment order for subscription"
echo "Required: RAZORPAY_KEY_ID, RAZORPAY_KEY_SECRET, Valid JWT"
echo "Auth: Yes (Bearer token required)"
echo ""
echo "curl -X POST $PROJECT_URL/functions/v1/create-razorpay-order \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -H 'Authorization: Bearer BEARER_TOKEN' \\"
echo "  -d '{"
echo "    \"planId\": \"monthly\"  /* Options: monthly, quarterly, yearly */"
echo "  }'"
echo ""
echo "Response: { success: true, order_id: \"...\", amount: 29900 }"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "7ï¸âƒ£  VERIFY PAYMENT"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Description: Verify Razorpay payment and activate subscription"
echo "Required: RAZORPAY_KEY_SECRET, Valid JWT"
echo "Auth: Yes (Bearer token required)"
echo ""
echo "curl -X POST $PROJECT_URL/functions/v1/verify-payment \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -H 'Authorization: Bearer BEARER_TOKEN' \\"
echo "  -d '{"
echo "    \"razorpay_order_id\": \"order_xxx\","
echo "    \"razorpay_payment_id\": \"pay_xxx\","
echo "    \"razorpay_signature\": \"signature_xxx\","
echo "    \"planId\": \"monthly\""
echo "  }'"
echo ""
echo "Note: Signature comes from Razorpay payment response"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "8ï¸âƒ£  CREATE BATCH ORDER"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Description: Create payment order for batch enrollment"
echo "Required: Valid JWT"
echo "Auth: Yes (Bearer token required)"
echo ""
echo "curl -X POST $PROJECT_URL/functions/v1/create-batch-order \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -H 'Authorization: Bearer BEARER_TOKEN' \\"
echo "  -d '{"
echo "    \"batchId\": \"batch-uuid\""
echo "  }'"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "9ï¸âƒ£  SYNC BATCH PAYMENT"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Description: Sync batch enrollment payment status"
echo "Required: RAZORPAY_KEY_SECRET, Valid JWT"
echo "Auth: Yes (Bearer token required)"
echo ""
echo "curl -X POST $PROJECT_URL/functions/v1/sync-batch-payment \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -H 'Authorization: Bearer BEARER_TOKEN' \\"
echo "  -d '{"
echo "    \"razorpay_order_id\": \"order_xxx\","
echo "    \"razorpay_payment_id\": \"pay_xxx\","
echo "    \"razorpay_signature\": \"signature_xxx\","
echo "    \"batchId\": \"batch-uuid\""
echo "  }'"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ”Ÿ EXTRACT PDF QUESTIONS"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Description: Extract questions from PDF file"
echo "Required: Valid JWT"
echo "Auth: Yes (Bearer token required)"
echo ""
echo "curl -X POST $PROJECT_URL/functions/v1/extract-pdf-questions \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -H 'Authorization: Bearer BEARER_TOKEN' \\"
echo "  -F 'file=@/path/to/file.pdf' \\"
echo "  -F 'subject=Physics' \\"
echo "  -F 'chapter=Mechanics'"
echo ""

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ” GETTING BEARER TOKEN"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "For authenticated endpoints, you need a JWT token:"
echo ""
echo "From Frontend (JavaScript):"
echo "  const { data: { session } } = await supabase.auth.getSession()"
echo "  const token = session?.access_token"
echo ""
echo "From Supabase CLI:"
echo "  supabase auth admin create-user --email user@example.com --password password"
echo ""

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… TESTING TIPS"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "1. Save responses to file:"
echo "   curl ... > response.json"
echo ""
echo "2. Pretty print JSON:"
echo "   curl ... | jq ."
echo ""
echo "3. See response headers:"
echo "   curl -v ... 2>&1"
echo ""
echo "4. Check function logs:"
echo "   supabase functions list -p ngduavjaiqyiqjzelfpl"
echo ""
echo "5. Test in Postman:"
echo "   Import the curl commands or use REST client"
echo ""

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ“š DOCUMENTATION"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "For complete documentation, see:"
echo "  â€¢ SUPABASE_SETUP_COMPLETE_GUIDE.md"
echo "  â€¢ README.md"
echo "  â€¢ supabase/functions/*/index.ts (function source code)"
echo ""
